{% from "@SyliusBootstrapAdminUi/shared/helper/accordion.html.twig" import accordion %}
{% import "@SyliusBootstrapAdminUi/shared/helper/button.html.twig" as button %}

{% set resources = gridView %}
{% set are_criteria_set = filterParameters is defined and filterParameters is not empty %}

{% if resources.definition.enabledFilters is not empty %}
    <div class="position-relative z-1 bg-white mb-5">
        {% set content %}
            <div class="mb-3">
                {{ form_start(form, {
                    'attr': {
                        'data-action': 'live#action:prevent',
                        'data-live-action-param': 'applyFilters',
                        'novalidate': true,
                        'data-model': "norender|*"
                    }
                }) }}
                    <div class="sylius-filters">
                        {% for filter in resources.definition.enabledFilters|filter(filter => filter.enabled)|sylius_sort_by('position') %}
                            <div class="sylius-filters__item">
                                {{ sylius_grid_render_filter(resources, filter, form) }}
                            </div>
                        {% endfor %}
                    </div>
                    <div>
                        <button type="submit"
                                class="btn btn-primary">
                            <i class="icon tabler:adjustments"></i>
                            {{ 'sylius.ui.filter'|trans }}
                        </button>
                        <button type="button"
                                data-action="live#action"
                                data-live-action-param="resetFilters"
                                class="btn btn-secondary">
                            {{ 'sylius.ui.reset'|trans }}
                        </button>
                    </div>
                {{ form_end(form, {'render_rest': false}) }}
            </div>
        {% endset %}

        {{ accordion([{
            title: 'sylius.ui.filters'|trans,
            content: content,
            icon: 'tabler:adjustments',
        }], are_criteria_set) }}
    </div>
{% endif %}
